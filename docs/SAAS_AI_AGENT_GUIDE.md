# SaaSãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã«ãŠã‘ã‚‹AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆæ´»ç”¨ã‚¬ã‚¤ãƒ‰ï¼šãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ã¨å®Ÿè£…

æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Amazon Bedrock AgentCoreã‚’ç”¨ã„ãŸãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆSaaSã«ãŠã‘ã‚‹AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã€Œãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ã€ã¨ã€ãã‚Œã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã®ã€ŒæŠ€è¡“çš„å®Ÿè£…æ–¹æ³•ã€ã‚’åŒ…æ‹¬çš„ã«è§£èª¬ã—ã¾ã™ã€‚

---

## ç¬¬1éƒ¨ï¼šãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ã¨ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å®šç¾©

å˜ãªã‚‹ã€Œãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã€ã§ã¯ãªãã€é¡§å®¢ä¼æ¥­ã®æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹ã«æ·±ãçµ±åˆã•ã‚ŒãŸã€Œãƒ‡ã‚¸ã‚¿ãƒ«ç¤¾å“¡ã€ã¨ã—ã¦ã®ä¾¡å€¤ã‚’å®šç¾©ã—ã¾ã™ã€‚

### 1. ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®ã‚³ã‚¢ãƒãƒªãƒ¥ãƒ¼ï¼ˆæä¾›ä¾¡å€¤ï¼‰

#### â‘  ğŸ”’ ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚°ãƒ¬ãƒ¼ãƒ‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨å®‰å¿ƒæ„Ÿ
**ã€Œè‡ªç¤¾ã®ãƒ‡ãƒ¼ã‚¿ã¯ã€è‡ªç¤¾ã®ãŸã‚ã ã‘ã«ä½¿ã‚ã‚Œã‚‹ã€**
- **æ©Ÿèƒ½**: ãƒ†ãƒŠãƒ³ãƒˆï¼ˆé¡§å®¢ä¼æ¥­ï¼‰ã”ã¨ã«å®Œå…¨ã«åˆ†é›¢ã•ã‚ŒãŸãƒ¡ãƒ¢ãƒªã¨ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã€‚
- **ä¾¡å€¤**: ç«¶åˆä»–ç¤¾ã¸ã®æƒ…å ±æµå‡ºã‚’æ‡¸å¿µã™ã‚‹ã“ã¨ãªãã€æ©Ÿå¯†æ€§ã®é«˜ã„ç¤¾å†…ãƒ‡ãƒ¼ã‚¿ï¼ˆé¡§å®¢ãƒªã‚¹ãƒˆã€æŠ€è¡“æ–‡æ›¸ã€è²¡å‹™ãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’AIã«æ‰±ã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

#### â‘¡ ğŸ§© è‡ªç¤¾ãƒ„ãƒ¼ãƒ«ã¨ã®ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªé€£æºï¼ˆDeep Integrationï¼‰
**ã€Œãƒãƒ£ãƒƒãƒˆç”»é¢ã‹ã‚‰ã€ã„ã¤ã‚‚ã®æ¥­å‹™ãƒ„ãƒ¼ãƒ«ã‚’æ“ä½œã™ã‚‹ã€**
- **æ©Ÿèƒ½**: é¡§å®¢ãŒå¥‘ç´„ã—ã¦ã„ã‚‹å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆSalesforce, GitHub, Jiraç­‰ï¼‰ã‚„ç¤¾å†…APIã¨ã®ã‚»ã‚­ãƒ¥ã‚¢ãªæ¥ç¶šã€‚
- **ä¾¡å€¤**: æƒ…å ±æ¤œç´¢ã®ãŸã‚ã ã‘ã«ãƒ„ãƒ¼ãƒ«ã‚’è¡Œãæ¥ã™ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™ã€‚AIãŒä»£ç†äººã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œç´¢ãƒ»æ›´æ–°ã—ã€æ¥­å‹™ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚

#### â‘¢ ğŸ¨ ã€Œè‡ªç¤¾ã‚‰ã—ã•ã€ã®åæ˜ ï¼ˆHyper-Personalizationï¼‰
**ã€Œã‚¦ãƒã®ä¼šç¤¾ã®ãƒ«ãƒ¼ãƒ«ã¨è¨€è‘‰ã§è©±ã™ã€**
- **æ©Ÿèƒ½**: é¡§å®¢ã”ã¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã€ãƒˆãƒ¼ãƒ³ï¼†ãƒãƒŠãƒ¼èª¿æ•´ã€ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«ã®é¸æŠã€‚
- **ä¾¡å€¤**: ã€Œå …ã„é‡‘èæ©Ÿé–¢å‘ã‘ã€ã‚„ã€Œãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—å‘ã‘ã€ãªã©ã€ä¼æ¥­ã®æ–‡åŒ–ã‚„è¦å®šã«åˆã‚ã›ãŸå¯¾è©±ãŒå¯èƒ½ã«ãªã‚Šã€é•å’Œæ„Ÿã®ãªã„å°å…¥ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

### 2. å…·ä½“çš„ãªæ©Ÿèƒ½ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹

#### Use Case A: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆèªè­˜å‹ãƒ»å–¶æ¥­æ”¯æ´ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ
**ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ**: CRM/SFAã€ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆãƒ„ãƒ¼ãƒ«
> **ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ã€Œæ¬¡ã®å•†è«‡ã«å‘ã‘ã¦ã€Aç¤¾ã®ç›´è¿‘ã®èª²é¡Œã¨éå»ã®ææ¡ˆå†…å®¹ã‚’ã¾ã¨ã‚ã¦ã€

*   **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“**:
    1.  ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒ**è‡ªç¤¾ã®CRM**ï¼ˆä¾‹: Salesforceï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€é¡§å®¢æƒ…å ±ã‚’å–å¾—ã€‚
    2.  éå»ã®ãƒ¡ãƒ¼ãƒ«ã‚„è­°äº‹éŒ²ï¼ˆ**ãƒ†ãƒŠãƒ³ãƒˆå›ºæœ‰ãƒ¡ãƒ¢ãƒª**ï¼‰ã‹ã‚‰æ–‡è„ˆã‚’åˆ†æã€‚
    3.  ã€ŒAç¤¾ã¯å…ˆæœˆã€‡ã€‡ã®æ©Ÿèƒ½ã«é–¢å¿ƒã‚’ç¤ºã—ã¦ãŠã‚Šã€æ‹…å½“è€…ã¯Ã—Ã—æ§˜ã§ã™ã€ã¨å›ç­”ã€‚
*   **ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤**: å•†è«‡æº–å‚™æ™‚é–“ã®50%å‰Šæ¸›ã€æ‹…å½“è€…å¤‰æ›´æ™‚ã®å¼•ãç¶™ãã‚³ã‚¹ãƒˆã‚¼ãƒ­åŒ–ã€‚

#### Use Case B: é–‹ç™ºãƒ»é‹ç”¨ï¼ˆDevOpsï¼‰ã‚³ãƒ³ãƒ‘ãƒ‹ã‚ªãƒ³
**ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã€é–‹ç™ºè€…å‘ã‘ãƒ„ãƒ¼ãƒ«
> **ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ã€Œå…ˆé€±ã®ãƒãƒ¼ã‚¸ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ç™ºç”Ÿã—ãŸãƒã‚°ã«é–¢é€£ã™ã‚‹ãƒã‚±ãƒƒãƒˆã‚’æ¢ã—ã¦ã€

*   **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“**:
    1.  ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒ**è‡ªç¤¾ã®ãƒªãƒã‚¸ãƒˆãƒª**ï¼ˆä¾‹: GitHub Enterpriseï¼‰ã¨ãƒã‚±ãƒƒãƒˆç®¡ç†ï¼ˆJiraï¼‰ã‚’æ¨ªæ–­æ¤œç´¢ã€‚
    2.  ã€ŒPR #123ã«é–¢é€£ã™ã‚‹ãƒã‚±ãƒƒãƒˆã¯KEY-456ã§ã™ã€‚ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ã¯S3ã®ãƒ­ã‚°ãƒã‚±ãƒƒãƒˆã«ã‚ã‚Šã¾ã™ã€ã¨ç‰¹å®šã€‚
*   **ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤**: éšœå®³èª¿æŸ»ã®åˆå‹•å¯¾å¿œã‚¹ãƒ”ãƒ¼ãƒ‰å‘ä¸Šã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚¹ã‚¤ãƒƒãƒã«ã‚ˆã‚‹ç”Ÿç”£æ€§ä½ä¸‹ã®é˜²æ­¢ã€‚

#### Use Case C: ç¤¾å†…è¦å®šæº–æ‹ ãƒ»ãƒŠãƒ¬ãƒƒã‚¸ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
**ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ**: ã‚°ãƒ«ãƒ¼ãƒ—ã‚¦ã‚§ã‚¢ã€HRãƒ†ãƒƒã‚¯ã€æ–‡æ›¸ç®¡ç†
> **ãƒ¦ãƒ¼ã‚¶ãƒ¼**: ã€Œæ¥é€±ã®å‡ºå¼µï¼ˆæµ·å¤–ï¼‰ã®çµŒè²»ç²¾ç®—ãƒ«ãƒ¼ãƒ«ã‚’æ•™ãˆã¦ã€‚ã‚ã¨ç”³è«‹ã®ä¸‹æ›¸ãã‚‚ä½œã£ã¦ã€

*   **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“**:
    1.  **è‡ªç¤¾ã®æœ€æ–°å°±æ¥­è¦å‰‡**ã®ã¿ã‚’å‚ç…§ã—ã¦å›ç­”ï¼ˆä»–ç¤¾ã®è¦å®šã¯æ··ã–ã‚‰ãªã„ï¼‰ã€‚
    2.  ä¼æ¥­ã®ãƒˆãƒ¼ãƒ³ã«åˆã‚ã›ã¦å›ç­”ï¼ˆä¾‹ï¼šã€Œè¦å®šç¬¬Xæ¡ã«ã‚ˆã‚Š...ã€ã¨å³æ ¼ã«ï¼‰ã€‚
    3.  ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«åˆã‚ã›ã¦ãƒ‰ãƒ©ãƒ•ãƒˆã‚’ä½œæˆã€‚
*   **ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤**: ãƒãƒƒã‚¯ã‚ªãƒ•ã‚£ã‚¹ã¸ã®å•ã„åˆã‚ã›å‰Šæ¸›ã€ç¤¾å†…ãƒ«ãƒ¼ãƒ«ã®éµå®ˆå¾¹åº•ã€‚

---

## ç¬¬2éƒ¨ï¼šæŠ€è¡“çš„å®Ÿè£…ã‚¬ã‚¤ãƒ‰

ç¬¬1éƒ¨ã®ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€çµ±åˆã€ãƒ‘ãƒ¼ã‚½ãƒŠãƒ©ã‚¤ã‚ºï¼‰ã‚’æ”¯ãˆã‚‹ãŸã‚ã®å®Ÿè£…ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã™ã€‚

### 1. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å…¨ä½“åƒ

```mermaid
graph TD
    User[ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼] --> Gateway[AgentCore Gateway<br>(APIç®¡ç†ãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)]
    Gateway --> Identity[AgentCore Identity<br>(èªè¨¼ãƒ»èªå¯)]
    Identity --> Runtime[AgentCore Runtime<br>(ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè¡ŒåŸºç›¤)]
    Runtime --> Memory[AgentCore Memory<br>(ãƒ†ãƒŠãƒ³ãƒˆåˆ¥ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢)]
    Runtime --> Tools[å¤–éƒ¨ãƒ„ãƒ¼ãƒ«é€£æº<br>(CRM, GitHub, etc)]
```

### 2. Tenant Aware Agent ãƒ‘ã‚¿ãƒ¼ãƒ³

SaaSã«ãŠã‘ã‚‹AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå®Ÿè£…ã®æ ¸å¿ƒã¨ãªã‚‹ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒ**ã€ŒTenant Aware Agentï¼ˆãƒ†ãƒŠãƒ³ãƒˆèªè­˜å‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆï¼‰ã€**ã§ã™ã€‚

ã“ã‚Œã¯ã€å…±é€šã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆDefault Configï¼‰ã‚’æŒã¡ãªãŒã‚‰ã€å®Ÿè¡Œæ™‚ã«å‹•çš„ã«ãƒ†ãƒŠãƒ³ãƒˆå›ºæœ‰ã®è¨­å®šï¼ˆTenant Configï¼‰ã‚’èª­ã¿è¾¼ã¿ã€æŒ¯ã‚‹èˆã„ã‚’ä¸Šæ›¸ãï¼ˆOverrideï¼‰ã™ã‚‹è¨­è¨ˆã§ã™ã€‚

#### ä»•çµ„ã¿: Default + Override ãƒ¢ãƒ‡ãƒ«

```python
class TenantAwareAgent:
    def get_agent_config(self, context: TenantContext, agent_name: str) -> AgentConfig:
        # 1. ã¾ãšãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’å–å¾—
        config = self.default_configs.get(agent_name)

        # 2. ãƒ†ãƒŠãƒ³ãƒˆå›ºæœ‰ã®è¨­å®šãŒã‚ã‚Œã°ä¸Šæ›¸ãï¼ˆOverrideï¼‰
        if context.tenant_id in self.tenant_configs:
             tenant_config = self.tenant_configs[context.tenant_id].get(agent_name)
             if tenant_config:
                 config = tenant_config

        # 3. ãƒ¢ãƒ‡ãƒ«ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®å‹•çš„ã‚¬ãƒãƒŠãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯
        if not TenantContextManager.validate_model_access(context, config.model):
            # è¨±å¯ã•ã‚Œã¦ã„ãªã„ãƒ¢ãƒ‡ãƒ«ãŒæŒ‡å®šã•ã‚Œã¦ã„ãŸå ´åˆã€å®‰å…¨ãªãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
            config.model = context.allowed_models[0]

        return config
```

**ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ¡ãƒªãƒƒãƒˆ:**
1.  **é‹ç”¨åŠ¹ç‡**: åŸºæœ¬çš„ãªæ©Ÿèƒ½æ›´æ–°ã¯ã€Œãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã€ã®ã¿ä¿®æ­£ã™ã‚Œã°å…¨ãƒ†ãƒŠãƒ³ãƒˆã«é©ç”¨ã•ã‚Œã‚‹ã€‚
2.  **æŸ”è»Ÿæ€§**: ç‰¹å®šã®ãƒ†ãƒŠãƒ³ãƒˆï¼ˆä¾‹: å¤§å£é¡§å®¢ï¼‰ã ã‘ã€å°‚ç”¨ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚„é«˜ä¾¡ãªãƒ¢ãƒ‡ãƒ«ï¼ˆClaude 3 Opusç­‰ï¼‰ã‚’å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ãŒå¯èƒ½ã€‚
3.  **ã‚¬ãƒãƒŠãƒ³ã‚¹**: ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«ã§ãƒ¢ãƒ‡ãƒ«åˆ©ç”¨æ¨©é™ã‚’å¼·åˆ¶ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãŸã‚ã€å¥‘ç´„å¤–ã®ãƒ¢ãƒ‡ãƒ«åˆ©ç”¨ã‚’é˜²ã’ã‚‹ã€‚

### 3. å…·ä½“çš„ãªå®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

#### â‘  ã€Securityã€‘ãƒ†ãƒŠãƒ³ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®åˆ†é›¢ã¨æ³¨å…¥
**ç›®çš„**: ã€ŒAç¤¾ã®ãƒ‡ãƒ¼ã‚¿ã¯Aç¤¾ã—ã‹è¦‹ã‚Œãªã„ã€ã‚’ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ™ãƒ«ã§ä¿è¨¼ã™ã‚‹ã€‚

ãƒªã‚¯ã‚¨ã‚¹ãƒˆã”ã¨ã«ã€Œã©ã®ãƒ†ãƒŠãƒ³ãƒˆã‹ã€ã‚’è­˜åˆ¥ã—ã€ãã®æƒ…å ±ã‚’ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ã—ã¦ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«æ³¨å…¥ã—ã¾ã™ã€‚

```python
from tenant.tenant_context import TenantContext

# ãƒªã‚¯ã‚¨ã‚¹ãƒˆå—ä¿¡æ™‚ï¼ˆAPIãƒãƒ³ãƒ‰ãƒ©ãƒ¼å†…ï¼‰
async def handle_request(request, tenant_id):
    # 1. ãƒ†ãƒŠãƒ³ãƒˆIDã«åŸºã¥ã„ãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç”Ÿæˆ
    #    - ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã€ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³IDãªã©ã‚’ç´ä»˜ã‘
    context = TenantContext(
        tenant_id=tenant_id,        # ä¾‹: "enterprise-corp"
        user_id=request.user_id,    # ä¾‹: "user-123"
        model_ids=["claude-3-5-sonnet"],
        session_id=request.session_id
    )

    # 2. ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®å®Ÿè¡Œï¼ˆã“ã®contextãŒå…¨åŸŸã«æ¸¡ã•ã‚Œã‚‹ï¼‰
    response = await agent.invoke(context, "assistant", request.message)
    return response
```

#### â‘¡ ã€Personalizationã€‘ãƒ†ãƒŠãƒ³ãƒˆã”ã¨ã®è¨­å®šç™»éŒ²
**ç›®çš„**: ã€Œä¼æ¥­ã”ã¨ã«ç•°ãªã‚‹å£èª¿ã€ãƒ«ãƒ¼ãƒ«ã€ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«ã€ã‚’é©ç”¨ã™ã‚‹ã€‚

```python
from tenant.tenant_aware_agent import AgentConfig

# ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆè¨­å®šã®ç™»éŒ²ï¼ˆãƒ†ãƒŠãƒ³ãƒˆã‚ªãƒ³ãƒœãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ™‚ã«å®Ÿè¡Œï¼‰
agent.register_tenant_agent(
    tenant_id="enterprise-corp",  # å¤§ä¼æ¥­å‘ã‘è¨­å®š
    agent_name="assistant",
    config=AgentConfig(
        name="assistant",
        # å³æ ¼ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
        prompt_template="ã‚ãªãŸã¯{tenant_id}ã®å…¬çš„ãªAIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€‚å¸¸ã«ã€Œã§ã™ãƒ»ã¾ã™ã€èª¿ã§ã€ç°¡æ½”ã«å›ç­”ã—ã¦ãã ã•ã„ã€‚\nãƒ¦ãƒ¼ã‚¶ãƒ¼: {user_message}",
        model="claude-3-sonnet",  # é«˜ç²¾åº¦ãƒ¢ãƒ‡ãƒ«
        tools=["crm_search", "approval_workflow"] # å°‚ç”¨ãƒ„ãƒ¼ãƒ«
    )
)
```

#### â‘¢ ã€Deep Integrationã€‘ã‚»ã‚­ãƒ¥ã‚¢ãªãƒ„ãƒ¼ãƒ«é€£æº
**ç›®çš„**: ã€Œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒé¡§å®¢ã®æ¨©é™ã§å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã‚’æ“ä½œã™ã‚‹ã€ã‚’å®Ÿç¾ã™ã‚‹ã€‚

Lambdaé–¢æ•°ã‚„APIã‚’ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ç™»éŒ²ã™ã‚‹éš›ã€**ãƒ†ãƒŠãƒ³ãƒˆã”ã¨ã®IAMãƒ­ãƒ¼ãƒ«**ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€Œé¡§å®¢Aã®ãƒ­ãƒ¼ãƒ«ã€ã‚’å¼•ãå—ã‘ã¦ï¼ˆAssume Roleï¼‰ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

```python
from agentcore.agentcore_gateway_config import AgentCoreGatewayConfig

gateway_config = AgentCoreGatewayConfig()

# Lambdaãƒ„ãƒ¼ãƒ«ã®ç™»éŒ²ï¼ˆCRMæ¤œç´¢ãªã©ï¼‰
gateway_config.register_lambda_tool(
    name="crm_search",
    function_arn="arn:aws:lambda:us-east-1:123:function:crm-search",
    # â˜…é‡è¦: ãƒ†ãƒŠãƒ³ãƒˆIDã¨IAMãƒ­ãƒ¼ãƒ«ã®ãƒãƒƒãƒ”ãƒ³ã‚°
    role_mapping={
        "enterprise-corp": "arn:aws:iam::123:role/enterprise-crm-role", # Aç¤¾ã®ãƒ‡ãƒ¼ã‚¿ã—ã‹èª­ã‚ãªã„ãƒ­ãƒ¼ãƒ«
        "startup-inc":     "arn:aws:iam::123:role/startup-basic-role"   # Bç¤¾ã®ãƒ‡ãƒ¼ã‚¿ã—ã‹èª­ã‚ãªã„ãƒ­ãƒ¼ãƒ«
    }
)
```

#### â‘£ ã€Infrastructureã€‘ãƒ†ãƒŠãƒ³ãƒˆã”ã¨ã®ãƒªã‚½ãƒ¼ã‚¹åˆ†é›¢ (IaC)
**ç›®çš„**: ã€Œç‰©ç†çš„ã«ã‚‚ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†ã‘ã‚‹ã€ã“ã¨ã§ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã‚’éµå®ˆã™ã‚‹ã€‚

AWS CloudFormationç­‰ã‚’ä½¿ç”¨ã—ã€ãƒ†ãƒŠãƒ³ãƒˆå¥‘ç´„æ™‚ã«å°‚ç”¨ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’è‡ªå‹•æ‰•ã„å‡ºã—ã—ã¾ã™ã€‚

```yaml
# cloudformation/tenant-infrastructure.yaml (æŠœç²‹)
Resources:
  # ãƒ†ãƒŠãƒ³ãƒˆå°‚ç”¨ã®S3ãƒã‚±ãƒƒãƒˆï¼ˆæ–‡æ›¸ãƒ‡ãƒ¼ã‚¿ä¿å­˜ç”¨ï¼‰
  TenantDataBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub 'tenant-${TenantId}-data-bucket'
      # æš—å·åŒ–è¨­å®š
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256

  # ãƒ†ãƒŠãƒ³ãƒˆå°‚ç”¨ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ—ãƒ¼ãƒ«ï¼ˆèªè¨¼ç”¨ï¼‰
  TenantUserPool:
    Type: AWS::Cognito::UserPool
    Properties:
      UserPoolName: !Sub 'tenant-${TenantId}-pool'
```
